services:
  galleon:
    image: ghcr.io/chenlizhan/galleon:latest
    container_name: galleon
    restart: always
    env_file: .env
    environment:
      PORT: "3000"
    mem_limit: 256m
    networks:
      - web
    healthcheck:
      test: ["CMD", "node", "-e", "require('http').get('http://localhost:3000/health', r => process.exit(r.statusCode === 200 ? 0 : 1)).on('error', () => process.exit(1))"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s

networks:
  web:
    external: true
